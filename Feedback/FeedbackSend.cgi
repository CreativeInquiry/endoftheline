#!/bin/perl — -*-perl-*-# ——————————————————————————————# Form-mail.pl, by Reuven M. Lerner (reuven@the-tech.mit.edu).## Last updated: March 14, 1994## Form-mail provides a mechanism by which users of a World-# Wide Web browser may submit comments to the webmasters# (or anyone else) at a site. It should be compatible with# any CGI-compatible HTTP server.# # Please read the README ﬁle that came with this distribution# for further details.# ——————————————————————————————# ——————————————————————————————# This package is Copyright 1994 by The Tech. # Form-mail is free software; you can redistribute it and/or modify it# under the terms of the GNU General Public License as published by the# Free Software Foundation; either version 2, or (at your option) any# later version.# Form-mail is distributed in the hope that it will be useful, but# WITHOUT ANY WARRANTY; without even the implied warranty of# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU# General Public License for more details.# You should have received a copy of the GNU General Public License# along with Form-mail; see the ﬁle COPYING. If not, write to the Free# Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.# ——————————————————————————————# Deﬁne fairly-constants# This should match the mail program on your system.$mailprog = ‘/usr/lib/sendmail’;# This should be set to the username or alias that runs your# WWW server.$recipient = ‘End_of_the_Line@pittsburgh.net’;# Print out a content-type for HTTP/1.0 compatibilityprint “Content-type: text/html\n\n”;# Print a title and initial headingprint “<Head><Title>Thank you</Title></Head>”;print “<BODY ALINK=#ffffff BGCOLOR=#ffffff LINK=#fc031e VLINK=#a400a4>”;# Get the inputread(STDIN, $buffer, $ENV{‘CONTENT_LENGTH’});# Split the varname-value pairs@pairs = split(/&/, $buffer);foreach $pair (@pairs){ ($varname, $value) = split(/=/, $pair); # Un-Webify plus signs and %-encoding $value =~ tr/+/ /; $value =~ s/%([a-fA-F0-9][a-fA-F0-9])/pack(“C”, hex($1))/eg; # Stop people from using subshells to execute commands # Not a big deal when using sendmail, but very important # when using UCB mail (aka mailx). # $value =~ s/~!/ ~!/g; # Uncomment for debugging purposes # print “Setting $varname to $value<P>”; $FORM{$varname} = $value;}# If the comments are blank, then give a “blank form” response#&blank_response unless $FORM{‘shmsg’};# Now send mail to $recipientopen (MAIL, “|$mailprog $recipient”) || die “Can’t open $mailprog!\n”;#print MAIL “Reply-to: ($FORM{‘shname’})\n”;print MAIL “Subject: End of the Line Feedback Form\n\n”;print MAIL “($FORM{‘shname’}) sent the following\n”;print MAIL “—————————————————————————————————-\n”;print MAIL “Name: $FORM{‘shname’}\n”;print MAIL “Email: $FORM{‘shemail’}\n”;print MAIL “Postal Address Line #1: $FORM{‘address1’}\n”;print MAIL “Postal Address Line #2: $FORM{‘address2’}\n\n”;print MAIL “End of the Line Sightings: $FORM{‘ques1’}\n\n”;print MAIL “Would you like to participate?: $FORM{‘ques2’}\n\n”;print MAIL “Do you have any stories?: $FORM{‘ques3’}\n\n”;print MAIL “Your general thoughts and comments: $FORM{‘ques4’}\n”;print MAIL “—————————————————————————————————\n”;print MAIL “Server protocol: $ENV{‘SERVER_PROTOCOL’}\n”;print MAIL “Remote host: $ENV{‘REMOTE_HOST’}\n”;print MAIL “Remote IP address: $ENV{‘REMOTE_ADDR’}\n”;close (MAIL);print “<P><CENTER><B><I><FONT SIZE=+1><BR>Thank you for your participation in the End of the Line project!</FONT></I></B></CENTER></P><P>Your contributed comments, stories or photographs will be posted onthe site in a few days, so please do stop by again.</P><P>—Carolyn P. Speranza and Lisa B. Link<br><FONT SIZE=-1><A HREF=http://pittsburgh.net/End_of_the_Line/>Return tothe End of the Line site</A></FONT>”;# Make the person feel good for writing to us#print “<HR><B>\&copy; 1996 Armco Inc.</B>”;#$way; # ——————————————————————————————# subroutine blank_responsesub blank_response{ print “Your comments appear to be blank, and thus were not sent “; print “to USA Waste. “; print “<P>”; exit;}